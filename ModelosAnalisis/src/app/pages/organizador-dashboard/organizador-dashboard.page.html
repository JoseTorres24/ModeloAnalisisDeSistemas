<ion-content [fullscreen]="true" class="dashboard-content">
  <div class="dashboard-container">
    <!-- Header Section -->
    <div class="hero-section">
      <div class="hero-inner">
        <h1 class="hero-title">Estadísticas generales</h1>
        <p class="hero-subtitle">Resumen de eventos y asistentes</p>
      </div>
    </div>

    <div class="main-layout">
      <!-- Main Content -->
      <div class="main-content">
        <!-- Stats Grid -->
        <div class="stats-grid">
          <ion-card class="stat-card featured-card">
            <ion-card-content>
              <div class="stat-icon-wrapper">
                <ion-icon name="calendar-outline" class="stat-icon"></ion-icon>
              </div>
              <h2 class="stat-value">{{ totalEvents }}</h2>
              <p class="stat-label">Total de eventos</p>
            </ion-card-content>
          </ion-card>

          <ion-card class="stat-card featured-card">
            <ion-card-content>
              <div class="stat-icon-wrapper">
                <ion-icon name="people-outline" class="stat-icon"></ion-icon>
              </div>
              <h2 class="stat-value">{{ totalAttendees }}</h2>
              <p class="stat-label">Asistentes totales</p>
            </ion-card-content>
          </ion-card>

          <ion-card class="stat-card featured-card">
            <ion-card-content>
              <div class="stat-icon-wrapper">
                <ion-icon name="checkmark-done-outline" class="stat-icon"></ion-icon>
              </div>
              <h2 class="stat-value">{{ approvedEvents }}</h2>
              <p class="stat-label">Eventos aprobados</p>
            </ion-card-content>
          </ion-card>
        </div>

        <!-- Recent Events Table -->
        <ion-card class="events-card featured-card">
          <ion-card-header>
            <ion-card-title>Eventos recientes</ion-card-title>
          </ion-card-header>
          <ion-card-content>
            <div class="table-container">
              <table class="events-table">
                <thead>
                  <tr>
                    <th>Evento</th>
                    <th>Fecha</th>
                    <th>Asistentes</th>
                    <th>Estado</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let event of recentEvents">
                    <td class="event-name">{{ event.name }}</td>
                    <td class="event-date">{{ event.date }}</td>
                    <td class="event-attendees">{{ event.attendees }}</td>
                    <td>
                      <ion-badge [class]="'status-badge status-' + event.status">
                        {{ getStatusText(event.status) }}
                      </ion-badge>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </ion-card-content>
        </ion-card>
      </div>

      <!-- Actions Sidebar -->
      <div class="actions-sidebar">
        <h3 class="sidebar-title">Acciones</h3>
        
        <ion-button expand="block" class="action-btn modern-btn primary" (click)="openCreateEventModal()">
          <ion-icon slot="start" name="add-outline"></ion-icon>
          Crear evento
        </ion-button>
        
        <ion-button expand="block" class="action-btn modern-btn secondary" (click)="openQRModal()">
          <ion-icon slot="start" name="qr-code-outline"></ion-icon>
          Generar QR
        </ion-button>
        
        <ion-button expand="block" class="action-btn modern-btn warning" (click)="openReportModal()">
          <ion-icon slot="start" name="document-text-outline"></ion-icon>
          Reportes
        </ion-button>
      </div>
    </div>
  </div>
</ion-content>

<!-- Modal para crear evento -->
<ion-modal [isOpen]="isCreateEventModalOpen" (didDismiss)="closeCreateEventModal()" class="custom-modal">
  <ng-template>
    <ion-header>
      <ion-toolbar>
        <ion-title>Crear Nuevo Evento</ion-title>
        <ion-buttons slot="end">
          <ion-button (click)="closeCreateEventModal()" class="modal-close-btn">
            <ion-icon name="close-outline"></ion-icon>
          </ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>
    <ion-content class="modal-content">
      <form [formGroup]="eventForm" (ngSubmit)="onEventSubmit()" class="event-form">
        <div class="form-section">
          <h4 class="section-title-qr">Información básica</h4>
          <div class="form-row">
            <ion-item class="form-item">
              <ion-label position="stacked">Título del Evento *</ion-label>
              <ion-input formControlName="title" type="text" placeholder="Ingresa el título"></ion-input>
            </ion-item>
            
            <ion-item class="form-item">
              <ion-label position="stacked">Categoría *</ion-label>
              <ion-select formControlName="category" placeholder="Selecciona categoría">
                <ion-select-option value="academico">Académico</ion-select-option>
                <ion-select-option value="cultural">Cultural</ion-select-option>
                <ion-select-option value="deportivo">Deportivo</ion-select-option>
                <ion-select-option value="otros">Otros</ion-select-option>
              </ion-select>
            </ion-item>
          </div>

          <ion-item class="form-item">
            <ion-label position="stacked">Descripción *</ion-label>
            <ion-textarea formControlName="description" rows="4" placeholder="Describe el evento"></ion-textarea>
          </ion-item>
        </div>

        <div class="form-section">
          <h4 class="section-title-qr">Fecha y ubicación</h4>
          <div class="form-row">
            <ion-item class="form-item">
              <ion-label position="stacked">Fecha *</ion-label>
              <ion-input formControlName="date" type="date"></ion-input>
            </ion-item>
            
            <ion-item class="form-item">
              <ion-label position="stacked">Hora de inicio *</ion-label>
              <ion-input formControlName="startTime" type="time"></ion-input>
            </ion-item>
          </div>

          <div class="form-row">
            <ion-item class="form-item">
              <ion-label position="stacked">Hora de fin *</ion-label>
              <ion-input formControlName="endTime" type="time"></ion-input>
            </ion-item>
            
            <ion-item class="form-item">
              <ion-label position="stacked">Capacidad máxima</ion-label>
              <ion-input formControlName="capacity" type="number" min="1" placeholder="Ej. 100"></ion-input>
            </ion-item>
          </div>

          <ion-item class="form-item">
            <ion-label position="stacked">Ubicación *</ion-label>
            <ion-input formControlName="location" type="text" placeholder="Lugar del evento"></ion-input>
          </ion-item>
        </div>

        <div class="form-section">
          <h4 class="section-title-qr">Configuración adicional</h4>
          <div class="form-row">
            <ion-item class="form-item">
              <ion-label position="stacked">Costo general</ion-label>
              <ion-input formControlName="cost" type="number" min="0" step="0.01" placeholder="0.00">
                <ion-icon slot="start" name="pricetag-outline"></ion-icon>
              </ion-input>
            </ion-item>
            
            <ion-item class="form-item">
              <ion-label position="stacked">Costo estudiantes</ion-label>
              <ion-input formControlName="studentCost" type="number" min="0" step="0.01" placeholder="0.00">
                <ion-icon slot="start" name="school-outline"></ion-icon>
              </ion-input>
            </ion-item>
          </div>

          <div class="checkbox-group">
            <ion-item class="checkbox-item">
              <ion-checkbox formControlName="isPublic" slot="start"></ion-checkbox>
              <ion-label>Evento público (visible para usuarios externos)</ion-label>
            </ion-item>

            <ion-item class="checkbox-item">
              <ion-checkbox formControlName="requiresApproval" slot="start"></ion-checkbox>
              <ion-label>Requiere aprobación de registro</ion-label>
            </ion-item>
          </div>
        </div>

        <div class="modal-actions">
          <ion-button expand="block" type="submit" [disabled]="!eventForm.valid" class="submit-btn modern-btn">
            Crear Evento
          </ion-button>
        </div>
      </form>
    </ion-content>
  </ng-template>
</ion-modal>

<!-- Modal para reportes -->
<ion-modal [isOpen]="isReportModalOpen" (didDismiss)="closeReportModal()" class="custom-modal">
  <ng-template>
    <ion-header>
      <ion-toolbar>
        <ion-title>Generar Reportes</ion-title>
        <ion-buttons slot="end">
          <ion-button (click)="closeReportModal()" class="modal-close-btn">
            <ion-icon name="close-outline"></ion-icon>
          </ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>
    <ion-content class="modal-content">
      <div class="reports-content">
        <ion-card class="report-option featured-card" (click)="generateGeneralReport()">
          <ion-card-content>
            <div class="report-icon-wrapper">
              <ion-icon name="stats-chart-outline"></ion-icon>
            </div>
            <h3>Reporte General</h3>
            <p>Resumen completo de todos los eventos y asistentes</p>
          </ion-card-content>
        </ion-card>

        <ion-card class="report-option featured-card" (click)="generateEventsReport()">
          <ion-card-content>
            <div class="report-icon-wrapper">
              <ion-icon name="calendar-outline"></ion-icon>
            </div>
            <h3>Reporte de Eventos</h3>
            <p>Detalles específicos de cada evento organizado</p>
          </ion-card-content>
        </ion-card>

        <ion-card class="report-option featured-card" (click)="generateAttendeesReport()">
          <ion-card-content>
            <div class="report-icon-wrapper">
              <ion-icon name="people-outline"></ion-icon>
            </div>
            <h3>Reporte de Asistentes</h3>
            <p>Información detallada sobre los participantes</p>
          </ion-card-content>
        </ion-card>
      </div>
    </ion-content>
  </ng-template>
</ion-modal>